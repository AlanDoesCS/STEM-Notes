% ----- fancy headers -----
\usepackage{fancyhdr}
\pagestyle{fancy}
\fancyhf{} % clear all

% SWAPPED: page numbers now at LO/RE (outer), titles mirrored
\fancyhead[LO,RE]{\thepage}                         % was [LE,RO]
\fancyhead[RO]{\nouppercase{\rightmark}}            % was [LO]
\fancyhead[LE]{\nouppercase{\leftmark}}             % was [RE]
\setlength{\headheight}{14pt}

% Populate header marks nicely (book class)
\renewcommand{\chaptermark}[1]{\markboth{#1}{}}
\renewcommand{\sectionmark}[1]{\markright{\thesection\ #1}}

% --- Make 'plain' pages truly plain (no header/footer) ---
% Used by title page, chapter openings, etc.
\fancypagestyle{plain}{%
	\fancyhf{}%
	% If you want a page number on plain pages, uncomment:
	% \fancyfoot[C]{\thepage}
}

% Optional: one-off style that keeps only a centered footer page number
\fancypagestyle{noheader}{%
	\fancyhf{}%
	\fancyfoot[C]{\thepage}%
}

% ----- SWAP ODD/EVEN MARGINS (offsets) -----
\makeatletter
\newlength\OddSideTmp
\setlength\OddSideTmp{\oddsidemargin}
\setlength{\oddsidemargin}{\evensidemargin}
\setlength{\evensidemargin}{\OddSideTmp}
\makeatother

% Less picky float placement
\makeatletter
\def\fps@figure{!htbp}
\def\fps@table{!htbp}
\makeatother

% Keep floats inside sections (or use [chapter] if you prefer)
\usepackage[section]{placeins}

% ----- Prevent extra blank after title page -----
\makeatletter
\renewcommand{\maketitle}{%
	\begin{titlepage}
		\thispagestyle{empty}
		\begin{center}
			{\LARGE\bfseries \@title \par}
			\vspace{1.5em}
			{\large \@author \par}
			\vspace{1em}
			{\large \the\year \par}
		\end{center}
	\end{titlepage}
	\clearpage % <-- only advance one page, not cleardoublepage
}
\makeatother

